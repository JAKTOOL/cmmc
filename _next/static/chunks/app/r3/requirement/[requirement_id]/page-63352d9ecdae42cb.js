(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{9271:(e,t,s)=>{Promise.resolve().then(s.bind(s,9751)),Promise.resolve().then(s.bind(s,3676)),Promise.resolve().then(s.bind(s,1996))},3676:(e,t,s)=>{"use strict";s.d(t,{SecurityRequirements:()=>x});var l=s(5155),i=s(1996),r=s(3272),n=s(4475),d=s(9645),a=s(2115);let o=e=>{let{id:t,defaultValue:s,isPending:i}=e,r=(0,a.useRef)(null);if(i){var n;return(0,l.jsxs)("select",{id:t,name:t,className:"rounded-lg p-4 bg-black/5 border-2 border-solid border-black/10 font-mono font-medium text-sm disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:!0,value:(null==r?void 0:null===(n=r.current)||void 0===n?void 0:n.value)||s,children:[(0,l.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,l.jsx)("option",{value:"implemented",children:"Implemented"}),(0,l.jsx)("option",{value:"not-applicable",children:"Not Applicable"})]},"".concat(t,"-pending"))}return(0,l.jsxs)("select",{id:t,name:t,ref:r,className:"rounded-lg p-4 bg-black/5 border-2 border-solid border-black/10 font-mono font-medium text-sm disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:i,defaultValue:s,children:[(0,l.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,l.jsx)("option",{value:"implemented",children:"Implemented"}),(0,l.jsx)("option",{value:"not-applicable",children:"Not Applicable"})]},t)},u=e=>{let{securityRequirement:t,initialState:s,isPending:i}=e,r="".concat(t.subSubRequirement,".status");return(0,l.jsxs)("div",{className:"flex flex-col mr-4",children:[(0,l.jsx)("label",{htmlFor:r,className:"font-semibold text-lg",children:"Status"}),(0,l.jsx)(o,{id:r,isPending:i,defaultValue:s[r]})]},r)},c=e=>{let{securityRequirement:t,initialState:s,isPending:i}=e,r="".concat(t.subSubRequirement,".description");return(0,l.jsxs)("div",{className:"flex flex-col grow",children:[(0,l.jsx)("label",{htmlFor:r,className:"font-semibold text-lg",children:"Description"}),(0,l.jsx)("textarea",{name:r,id:r,rows:"5",maxLength:"256",required:"",placeholder:"[Max 256 chars]",className:"grow rounded-lg p-4 bg-black/5 border-2 border-solid border-black/10 font-mono font-medium text-sm disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:i,defaultValue:s[r]})]})},b=e=>{let{securityRequirement:t,initialState:s,isPending:i}=e;return(0,l.jsx)("li",{children:(0,l.jsxs)("fieldset",{className:"flex flex-col grow",children:[(0,l.jsxs)("legend",{className:"text-2xl flex flex-row items-center justify-center",children:[(0,l.jsx)(d.o,{status:s["".concat(t.subSubRequirement,".status")]}),t.subSubRequirement]}),(0,l.jsx)("p",{className:"text-lg",children:t.text}),(0,l.jsxs)("div",{className:"flex flex-row",children:[(0,l.jsx)(u,{securityRequirement:t,initialState:s,isPending:i}),(0,l.jsx)(c,{securityRequirement:t,initialState:s,isPending:i})]})]})})},m=e=>{var t;let{requirement:s,initialState:i,setInitialState:n,groupings:d,isHydrating:o,setStatuses:u}=e;async function c(e,t){let l=await r.x,i=l.transaction("security_requirements","readwrite").objectStore("security_requirements"),d={};for(let e of t.entries()){let[t,s]=e,l=t.lastIndexOf("."),i=t.substring(0,l),r=t.substring(l+1);d[i]={...(null==d?void 0:d[i])||{},[r]:s}}for(let[e,t]of Object.entries(d))i.put({id:e,...t});let a=l.transaction("requirements","readwrite").objectStore("requirements"),o=[];a.put({id:s.element_identifier,bySecurityRequirementId:Object.entries(d).reduce((e,t)=>{let[s,l]=t;return e[s]=l.status,o.push(l.status),e},{})}),u(o),n(Object.fromEntries(t.entries()))}let[m,x,f]=(0,a.useActionState)(c,i);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("form",{id:s.element_identifier,action:x,children:[(0,l.jsx)("button",{type:"submit",className:"bg-green-500 hover:bg-green-400 text-white font-bold py-2 px-4 border-b-4 border-green-700 hover:border-green-500 rounded disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none sticky top-4 left-full z-30",disabled:f||o,children:"Save"}),null===(t=Object.entries(d))||void 0===t?void 0:t.map(e=>{let[t,s]=e;return(0,l.jsx)("ol",{children:s.map(e=>(0,l.jsx)(b,{securityRequirement:e,initialState:i,isPending:f||o},e.element_identifier))},t)})]})})},x=e=>{var t,s;let{requirementId:o}=e,[u,c]=(0,a.useState)({}),[b,x]=(0,a.useState)(!1),[f,h]=(0,a.useState)([]),p=(0,i.u2)(),j=(0,a.useMemo)(()=>(null==p?void 0:p.securityRequirements.byRequirements[o])||[],[p,o]),g=(0,a.useMemo)(()=>(null==p?void 0:p.requirements.byId[o])||null,[p,o]),v=(0,a.useMemo)(()=>{let e={};for(let t of j)t.text&&(e[t.subRequirement]||(e[t.subRequirement]=[]),e[t.subRequirement].push(t));return e},[j]);return((0,a.useEffect)(()=>{(async function(){x(!0);let e=(await r.x).transaction("security_requirements","readonly").objectStore("security_requirements"),t=j.map(e=>e.subSubRequirement),s=e.getAll(IDBKeyRange.bound(t[0],t[t.length-1]));s.onsuccess=()=>{var e;let t=[],l=null==s?void 0:null===(e=s.result)||void 0===e?void 0:e.reduce((e,s)=>(e["".concat(s.id,".status")]=s.status,e["".concat(s.id,".description")]=s.description,t.push(s.status),e),{});h(t),c(l),x(!1)},s.onerror=()=>{x(!1)}})()},[o,c]),null==j?void 0:j.length)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.B,{requirementId:o}),(0,l.jsx)("br",{}),(0,l.jsxs)("h3",{className:"text-3xl",children:["Security Requirements for ",g.requirement," ",g.title,(0,l.jsx)(d.o,{statuses:f})]}),(0,l.jsx)("p",{className:"text-base",children:null===(s=p.discussions.byRequirements[o])||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.text}),(0,l.jsx)("section",{className:"w-full",children:(0,l.jsx)(m,{requirement:g,groupings:v,initialState:u,setInitialState:c,isHydrating:b,setStatuses:h})})]}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[396,681,441,517,358],()=>t(9271)),_N_E=e.O()}]);