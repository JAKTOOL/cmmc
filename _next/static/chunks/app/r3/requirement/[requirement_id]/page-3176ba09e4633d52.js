(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{9271:(e,t,r)=>{Promise.resolve().then(r.bind(r,9751)),Promise.resolve().then(r.bind(r,4389)),Promise.resolve().then(r.bind(r,1996))},4389:(e,t,r)=>{"use strict";r.d(t,{SecurityRequirements:()=>g});var s=r(5155),n=r(1996),i=r(3272),l=r(6658),o=r(4475),a=r(7396);let d=e=>{let{previous:t,next:r}=e,n="rounded-r-lg rounded-l-lg";t&&(n="rounded-r-lg");let i="rounded-r-lg rounded-l-lg";return r&&(i="rounded-l-lg border-r"),(0,s.jsxs)("aside",{className:"w-5/6 flex flex-row",children:[t&&(0,s.jsxs)(a.default,{href:"/r3/requirement/".concat(t.requirement),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(i),children:[(0,s.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),(0,s.jsxs)("span",{className:"mr-4 ml-2",children:[t.requirement,": ",t.title]})]}),r&&(0,s.jsxs)(a.default,{href:"/r3/requirement/".concat(r.requirement),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(n),children:[(0,s.jsxs)("span",{className:"ml-4 mr-2",children:[r.requirement,": ",r.title]}),(0,s.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})]})};var u=r(9645),c=r(2115);let m=e=>{let{id:t,defaultValue:r,isPending:n}=e,i=(0,c.useRef)(null);if(n){var l;return(0,s.jsxs)("select",{id:t,name:t,className:"h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",disabled:!0,value:(null==i?void 0:null===(l=i.current)||void 0===l?void 0:l.value)||r,children:[(0,s.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,s.jsx)("option",{value:"implemented",children:"Implemented"}),(0,s.jsx)("option",{value:"not-applicable",children:"Not Applicable"})]},"".concat(t,"-pending"))}return(0,s.jsxs)("select",{id:t,name:t,ref:i,className:"h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",disabled:n,defaultValue:r,children:[(0,s.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,s.jsx)("option",{value:"implemented",children:"Implemented"}),(0,s.jsx)("option",{value:"not-applicable",children:"Not Applicable"})]},t)},x=e=>{let{securityRequirement:t,initialState:r,isPending:n}=e,i="".concat(t.subSubRequirement,".status");return(0,s.jsxs)("div",{className:"flex flex-col mr-4",children:[(0,s.jsx)("label",{htmlFor:i,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 my-2",children:"Status"}),(0,s.jsx)(m,{id:i,isPending:n,defaultValue:r[i]})]},i)},b=e=>{let{securityRequirement:t,initialState:r,isPending:n}=e,i="".concat(t.subSubRequirement,".description");return(0,s.jsxs)("div",{className:"flex flex-col grow",children:[(0,s.jsx)("label",{htmlFor:i,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 my-2",children:"Description"}),(0,s.jsx)("textarea",{name:i,id:i,rows:5,className:"grow w-full rounded-md border border-input bg-transparent px-3 py-3 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",disabled:n,defaultValue:r[i]})]})},f=e=>{let{securityRequirement:t,initialState:r,isPending:n}=e;return(0,s.jsx)("li",{className:"mb-4",children:(0,s.jsxs)("fieldset",{className:"flex flex-col grow",children:[(0,s.jsxs)("legend",{className:"text-2xl flex flex-row items-center justify-center",children:[(0,s.jsx)(u.o,{status:r["".concat(t.subSubRequirement,".status")]}),(0,s.jsx)("h4",{id:t.subSubRequirement,children:t.subSubRequirement})]}),(0,s.jsx)("p",{className:"text-lg my-2",children:t.text}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)(x,{securityRequirement:t,initialState:r,isPending:n}),(0,s.jsx)(b,{securityRequirement:t,initialState:r,isPending:n})]})]})})},p=async(e,t)=>{let r=await i.x,s=null==r?void 0:r.transaction("security_requirements","readwrite").objectStore("security_requirements"),n={};for(let[e,r]of t.entries()){let t=e.lastIndexOf("."),s=e.substring(0,t),i=e.substring(t+1);n[s]={...(null==n?void 0:n[s])||{},[i]:r}}for(let[e,t]of Object.entries(n))null==s||s.put({id:e,...t});let l=null==r?void 0:r.transaction("requirements","readwrite").objectStore("requirements"),o=[];return null==l||l.put({id:e,bySecurityRequirementId:Object.entries(n).reduce((e,t)=>{let[r,s]=t;return e[r]=s.status,o.push(s.status),e},{})}),o},h=e=>{var t;let{requirement:r,initialState:n,setInitialState:i,groupings:l,isHydrating:o,setStatuses:a,prev:u,next:m}=e,[x,b]=(0,c.useState)(null);async function h(e,t){a(await p(r.id,t)),i(Object.fromEntries(t.entries())),b(new Date)}let g=(0,c.useMemo)(()=>(function(e,t){let r;return function(){for(var s=arguments.length,n=Array(s),i=0;i<s;i++)n[i]=arguments[i];r&&clearTimeout(r),r=setTimeout(()=>{e.apply(this,n)},t)}})(e=>{let t=new FormData(e.target.form);a(p(r.id,t)),i(Object.fromEntries(t.entries())),b(new Date)},250),[r.id,a,i]),[v,y,w]=(0,c.useActionState)(h,n);return(0,s.jsxs)("form",{id:r.element_identifier,action:y,onChange:g,className:"basis-full",children:[(0,s.jsx)(d,{previous:u,next:m}),(0,s.jsxs)("div",{className:"sticky top-32 left-full z-30 flex flex-row-reverse items-center shrink-0 w-1/2",style:{transform:"translateY(-100%)"},children:[(0,s.jsx)("button",{type:"submit",className:"shrink w-24 bg-green-500 hover:bg-green-400 text-white font-bold py-2 px-4 border-b-4 border-green-700 hover:border-green-500 rounded disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:o,children:"Save"}),x&&(0,s.jsxs)("span",{className:"text-sm text-gray-500 mr-4",children:["Last saved: ",null==x?void 0:x.toLocaleTimeString()]})]}),null===(t=Object.entries(l))||void 0===t?void 0:t.map(e=>{let[t,r]=e;return(0,s.jsx)("ol",{children:r.map(e=>(0,s.jsx)(f,{securityRequirement:e,initialState:n,isPending:w||o},e.element_identifier))},t)})]})},g=e=>{var t,r;let{requirementId:a}=e,[d,m]=(0,c.useState)({}),[x,b]=(0,c.useState)(!1),[f,p]=(0,c.useState)([]),g=(0,n.u2)(),v=(0,l.useRouter)(),y=(0,c.useMemo)(()=>(null==g?void 0:g.securityRequirements.byRequirements[a])||[],[g,a]),w=(0,c.useMemo)(()=>(null==g?void 0:g.requirements.byId[a])||null,[g,a]),j=(0,c.useMemo)(()=>{let e={};for(let t of y)t.text&&(e[t.subRequirement]||(e[t.subRequirement]=[]),e[t.subRequirement].push(t));return e},[y]),[q,N]=(0,c.useMemo)(()=>{let e=(null==g?void 0:g.requirements.byFamily[null==w?void 0:w.family])||[],t=e.findIndex(e=>e.id===a),r=e[t-1],s=e[t+1];if(!r||!s){var n,i,l;let e=g.families.elements,t=e.findIndex(e=>e.id===w.family);if(!r){let s=null==e?void 0:null===(n=e[t-1])||void 0===n?void 0:n.id,i=g.requirements.byFamily[s];r=null==i?void 0:i[(null==i?void 0:i.length)-1]}if(!s){let r=null==e?void 0:null===(i=e[t+1])||void 0===i?void 0:i.id;s=null===(l=g.requirements.byFamily[r])||void 0===l?void 0:l[0]}}return[r,s]},[w,a]);return((0,c.useEffect)(()=>{(async function(){b(!0);let e=(await i.x).transaction("security_requirements","readonly").objectStore("security_requirements"),t=y.map(e=>e.subSubRequirement),r=e.getAll(IDBKeyRange.bound(t[0],t[t.length-1]));r.onsuccess=()=>{var e;let t=[],s=null==r?void 0:null===(e=r.result)||void 0===e?void 0:e.reduce((e,r)=>(e["".concat(r.id,".status")]=r.status,e["".concat(r.id,".description")]=r.description,t.push(r.status),e),{});p(t),m(s),b(!1)},r.onerror=()=>{b(!1)}})()},[a,m,y]),(0,c.useEffect)(()=>{let e=e=>{let t=new URL("".concat(window.location.origin,"/").concat(e.newURL.split("#")[1]));history.replaceState(null,"",window.location.pathname+window.location.search),v.push("/r3/requirement/".concat(t.searchParams.get("element")))};return window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}},[]),null==y?void 0:y.length)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.B,{requirementId:a}),(0,s.jsx)("br",{}),(0,s.jsxs)("h3",{className:"text-3xl",children:["Security Requirements for ",w.requirement," ",w.title,(0,s.jsx)(u.o,{statuses:f})]}),(0,s.jsx)("p",{className:"text-base discussion",dangerouslySetInnerHTML:{__html:(null===(r=g.discussions.byRequirements[a])||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.text)||""}}),(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)(h,{requirement:w,groupings:j,initialState:d,setInitialState:m,isHydrating:x,setStatuses:p,prev:q,next:N})})]}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[396,681,441,517,358],()=>t(9271)),_N_E=e.O()}]);