(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{9271:(e,t,l)=>{Promise.resolve().then(l.bind(l,9751)),Promise.resolve().then(l.bind(l,7920)),Promise.resolve().then(l.bind(l,1996))},7920:(e,t,l)=>{"use strict";l.d(t,{SecurityRequirements:()=>h});var r=l(5155),s=l(1996),i=l(3272),n=l(4475),d=l(7396);let a=e=>{let{previous:t,next:l}=e,s="rounded-r-lg rounded-l-lg";t&&(s="rounded-r-lg");let i="rounded-r-lg rounded-l-lg";return l&&(i="rounded-l-lg border-r"),(0,r.jsxs)("aside",{className:"flex flex-row",children:[t&&(0,r.jsxs)(d.default,{href:"/r3/requirement/".concat(t.requirement),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(i),children:[(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})}),(0,r.jsxs)("span",{className:"mr-4 ml-2",children:[t.requirement,": ",t.title]})]}),l&&(0,r.jsxs)(d.default,{href:"/r3/requirement/".concat(l.requirement),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(s),children:[(0,r.jsxs)("span",{className:"ml-4 mr-2",children:[l.requirement,": ",l.title]}),(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})})]})]})};var o=l(9645),u=l(2115);let c=e=>{let{id:t,defaultValue:l,isPending:s}=e,i=(0,u.useRef)(null);if(s){var n;return(0,r.jsxs)("select",{id:t,name:t,className:"rounded-lg p-4 bg-black/5 border-2 border-solid border-black/10 font-mono font-medium text-sm disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:!0,value:(null==i?void 0:null===(n=i.current)||void 0===n?void 0:n.value)||l,children:[(0,r.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,r.jsx)("option",{value:"implemented",children:"Implemented"}),(0,r.jsx)("option",{value:"not-applicable",children:"Not Applicable"})]},"".concat(t,"-pending"))}return(0,r.jsxs)("select",{id:t,name:t,ref:i,className:"rounded-lg p-4 bg-black/5 border-2 border-solid border-black/10 font-mono font-medium text-sm disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:s,defaultValue:l,children:[(0,r.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,r.jsx)("option",{value:"implemented",children:"Implemented"}),(0,r.jsx)("option",{value:"not-applicable",children:"Not Applicable"})]},t)},m=e=>{let{securityRequirement:t,initialState:l,isPending:s}=e,i="".concat(t.subSubRequirement,".status");return(0,r.jsxs)("div",{className:"flex flex-col mr-4",children:[(0,r.jsx)("label",{htmlFor:i,className:"font-semibold text-lg",children:"Status"}),(0,r.jsx)(c,{id:i,isPending:s,defaultValue:l[i]})]},i)},b=e=>{let{securityRequirement:t,initialState:l,isPending:s}=e,i="".concat(t.subSubRequirement,".description");return(0,r.jsxs)("div",{className:"flex flex-col grow",children:[(0,r.jsx)("label",{htmlFor:i,className:"font-semibold text-lg",children:"Description"}),(0,r.jsx)("textarea",{name:i,id:i,rows:"5",maxLength:"256",required:"",placeholder:"[Max 256 chars]",className:"grow rounded-lg p-4 bg-black/5 border-2 border-solid border-black/10 font-mono font-medium text-sm disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:s,defaultValue:l[i]})]})},x=e=>{let{securityRequirement:t,initialState:l,isPending:s}=e;return(0,r.jsx)("li",{children:(0,r.jsxs)("fieldset",{className:"flex flex-col grow",children:[(0,r.jsxs)("legend",{className:"text-2xl flex flex-row items-center justify-center",children:[(0,r.jsx)(o.o,{status:l["".concat(t.subSubRequirement,".status")]}),t.subSubRequirement]}),(0,r.jsx)("p",{className:"text-lg",children:t.text}),(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)(m,{securityRequirement:t,initialState:l,isPending:s}),(0,r.jsx)(b,{securityRequirement:t,initialState:l,isPending:s})]})]})})},f=e=>{var t;let{requirement:l,initialState:s,setInitialState:n,groupings:d,isHydrating:a,setStatuses:o}=e;async function c(e,t){let r=await i.x,s=r.transaction("security_requirements","readwrite").objectStore("security_requirements"),d={};for(let e of t.entries()){let[t,l]=e,r=t.lastIndexOf("."),s=t.substring(0,r),i=t.substring(r+1);d[s]={...(null==d?void 0:d[s])||{},[i]:l}}for(let[e,t]of Object.entries(d))s.put({id:e,...t});let a=r.transaction("requirements","readwrite").objectStore("requirements"),u=[];a.put({id:l.element_identifier,bySecurityRequirementId:Object.entries(d).reduce((e,t)=>{let[l,r]=t;return e[l]=r.status,u.push(r.status),e},{})}),o(u),n(Object.fromEntries(t.entries()))}let[m,b,f]=(0,u.useActionState)(c,s);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("form",{id:l.element_identifier,action:b,children:[(0,r.jsx)("button",{type:"submit",className:"bg-green-500 hover:bg-green-400 text-white font-bold py-2 px-4 border-b-4 border-green-700 hover:border-green-500 rounded disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none sticky top-24 left-full z-30",disabled:f||a,children:"Save"}),null===(t=Object.entries(d))||void 0===t?void 0:t.map(e=>{let[t,l]=e;return(0,r.jsx)("ol",{children:l.map(e=>(0,r.jsx)(x,{securityRequirement:e,initialState:s,isPending:f||a},e.element_identifier))},t)})]})})},h=e=>{var t,l,d,c,m;let{requirementId:b}=e,[x,h]=(0,u.useState)({}),[g,p]=(0,u.useState)(!1),[v,j]=(0,u.useState)([]),y=(0,s.u2)(),q=(0,u.useMemo)(()=>(null==y?void 0:y.securityRequirements.byRequirements[b])||[],[y,b]),w=(0,u.useMemo)(()=>(null==y?void 0:y.requirements.byId[b])||null,[y,b]),N=(0,u.useMemo)(()=>(null==y?void 0:y.requirements.byFamily[null==w?void 0:w.family])||[],[b]),S=N.findIndex(e=>e.id===b),k=(0,u.useMemo)(()=>{let e={};for(let t of q)t.text&&(e[t.subRequirement]||(e[t.subRequirement]=[]),e[t.subRequirement].push(t));return e},[q]);if((0,u.useEffect)(()=>{(async function(){p(!0);let e=(await i.x).transaction("security_requirements","readonly").objectStore("security_requirements"),t=q.map(e=>e.subSubRequirement),l=e.getAll(IDBKeyRange.bound(t[0],t[t.length-1]));l.onsuccess=()=>{var e;let t=[],r=null==l?void 0:null===(e=l.result)||void 0===e?void 0:e.reduce((e,l)=>(e["".concat(l.id,".status")]=l.status,e["".concat(l.id,".description")]=l.description,t.push(l.status),e),{});j(t),h(r),p(!1)},l.onerror=()=>{p(!1)}})()},[b,h]),!(null==q?void 0:q.length))return null;let R=N[S-1],_=N[S+1];if(!R||!_){let e=y.families.elements,t=e.findIndex(e=>e.id===w.family);if(!R){let l=null==e?void 0:null===(d=e[t-1])||void 0===d?void 0:d.id,r=y.requirements.byFamily[l];R=null==r?void 0:r[(null==r?void 0:r.length)-1]}if(!_){let l=null==e?void 0:null===(c=e[t+1])||void 0===c?void 0:c.id;_=null===(m=y.requirements.byFamily[l])||void 0===m?void 0:m[0]}}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.B,{requirementId:b}),(0,r.jsx)("br",{}),(0,r.jsxs)("h3",{className:"text-3xl",children:["Security Requirements for ",w.requirement," ",w.title,(0,r.jsx)(o.o,{statuses:v})]}),(0,r.jsx)("p",{className:"text-base",children:null===(l=y.discussions.byRequirements[b])||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.text}),(0,r.jsx)(a,{previous:R,next:_}),(0,r.jsx)("section",{className:"w-full",children:(0,r.jsx)(f,{requirement:w,groupings:k,initialState:x,setInitialState:h,isHydrating:g,setStatuses:j})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[396,681,441,517,358],()=>t(9271)),_N_E=e.O()}]);