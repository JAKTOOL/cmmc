(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{93:(e,t,r)=>{"use strict";r.d(t,{SecurityRequirements:()=>O});var l=r(5155),n=r(6236),s=r(5383),i=r(8947),a=r(5695),o=r(2115),d=r(170),u=r(8870),c=r(6874),m=r.n(c),x=r(2932);let v=e=>{let{rows:t}=e;return(0,l.jsx)("dl",{className:"flex flex-row",children:t.reduce((e,t,r)=>(void 0!==t.visible&&t.visible&&e.push((0,l.jsxs)("div",{className:t.className||"",children:[(0,l.jsx)("dt",{className:"text-xs text-gray-700 uppercase bg-gray-50 text-gray-700 border-gray-100 py-2 px-4 text-left border-r-2 border-b-2",children:t.title}),(0,l.jsx)("dd",{className:"text-xs text-gray-500 bg-white border-gray-200 py-2 px-4",children:t.value})]},r)),e),[])})};var p=r(8202),h=r(3437),f=r(2954),b=r(6616);let g=e=>new Promise((t,r)=>{let l=new FileReader;l.onload=()=>t(l.result),l.onerror=e=>r(e),l.readAsArrayBuffer(e)}),j=e=>new Promise((t,r)=>{let l=new FileReader;l.onload=()=>t(l.result),l.onerror=e=>r(e),l.readAsDataURL(e)}),w=async e=>{let{requirementId:t,type:r,name:l,data:n}=e,s=[...new Uint8Array(await window.crypto.subtle.digest("SHA-1",n))].map(e=>e.toString(16).padStart(2,"0")).join(""),i=r.includes("image/")?".".concat(r.replace("image/","")):"",a=l||"".concat(s.slice(0,8)).concat(i);return{uuid:s,filename:a,type:r,data:n,requirement_id:t}},y=()=>(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"h-4 mr-1",children:(0,l.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 12.5V6.8c0-1.68 0-2.52-.327-3.162a3 3 0 0 0-1.311-1.311C17.72 2 16.88 2 15.2 2H8.8c-1.68 0-2.52 0-3.162.327a3 3 0 0 0-1.311 1.311C4 4.28 4 5.12 4 6.8v10.4c0 1.68 0 2.52.327 3.162a3 3 0 0 0 1.311 1.311C6.28 22 7.12 22 8.8 22h3.7m2.5-3 3 3m0 0 3-3m-3 3v-6"})}),N=()=>(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"h-4 mr-1",children:(0,l.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})}),k=()=>(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"h-4 mr-1",children:(0,l.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 9V3m0 0h-6m6 0-8 8m-3-6H7.8c-1.68 0-2.52 0-3.162.327a3 3 0 0 0-1.311 1.311C3 7.28 3 8.12 3 9.8v6.4c0 1.68 0 2.52.327 3.162a3 3 0 0 0 1.311 1.311C5.28 21 6.12 21 7.8 21h6.4c1.68 0 2.52 0 3.162-.327a3 3 0 0 0 1.311-1.311C19 18.72 19 17.88 19 16.2V14"})}),q=e=>{let{requirementId:t,setUploading:r,uploading:n}=e,i=async e=>{var l;if(r(!0),null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.files){for(let r of e.target.files){let e=await g(r),l=await w({name:r.name,type:r.type,data:e,requirementId:t});await s.Iq.evidence.put(l)}r(!1)}};return(0,l.jsxs)("label",{htmlFor:"evidence",className:"flex flex-col items-center justify-center border border-gray-200 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,l.jsx)("svg",{className:"w-8 h-8 mb-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:(0,l.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),(0,l.jsxs)("p",{className:"mb-2 text-sm text-gray-500 p-2",children:["Click or drop evidence for ",t]})]}),(0,l.jsx)("input",{id:"evidence",type:"file",className:"hidden",multiple:!0,onChange:i,disabled:n})]})},S=e=>{let{children:t,onDelete:r}=e;return(0,l.jsxs)("span",{className:"flex shrink items-center max-h-[20px] bg-blue-100 text-blue-800 border border-blue-200 text-xs font-medium me-2 mb-2 px-2.5 py-0.5 rounded-sm",children:[t,(0,l.jsx)("button",{onClick:r,className:"pl-2",children:(0,l.jsx)("svg",{className:"w-2 h-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:(0,l.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})})})]})},R=e=>{let{artifact:t}=e,r=async()=>{let e=new File([t.data],t.filename,{type:t.type}),r=await j(e);Object.assign(document.createElement("a"),{target:"_blank",rel:"noopener noreferrer",href:r}).click()};return(0,l.jsxs)("button",{className:"border-r border-blue-200 pr-2 flex",title:"".concat(t.data.byteLength," bytes | ").concat(t.type),onClick:r,children:[(0,l.jsx)(y,{}),(0,l.jsx)("span",{children:t.filename})]})},I=e=>{let{artifact:t}=e,r=new TextDecoder().decode(t.data),n=async()=>{Object.assign(document.createElement("a"),{target:"_blank",rel:"noopener noreferrer",href:r}).click()};return(0,l.jsxs)("button",{className:"border-r border-blue-200 pr-2 flex",title:"".concat(r),onClick:n,children:[(0,l.jsx)(k,{}),(0,l.jsx)("span",{children:t.filename})]})},_=e=>{let{artifact:t,setEvidence:r,evidence:n}=e,i=async()=>{await s.Iq.evidence.delete(IDBKeyRange.only(t.uuid))&&r(n.filter(e=>e.uuid!==t.uuid))};return(0,l.jsx)(S,{onDelete:i,children:"url"===t.type?(0,l.jsx)(I,{artifact:t}):(0,l.jsx)(R,{artifact:t})})},L=e=>{let{evidence:t,setEvidence:r}=e;return null==t?void 0:t.map(e=>(0,l.jsx)(_,{artifact:e,evidence:t,setEvidence:r},e.uuid))};async function E(e,t){t(await s.Iq.evidence.getAll(IDBKeyRange.only(e),"requirement_id"))}let C=e=>{let{requirementId:t}=e,[r,n]=(0,o.useState)([]),[i,a]=(0,o.useState)(!1);(0,o.useEffect)(()=>{i||E(t,n)},[t,i]),(0,o.useEffect)(()=>{let e=function(e,t,r){return async function(t){try{var l,n,i,a,o,d;if(["TEXTAREA","INPUT"].includes(null==t?void 0:null===(l=t.target)||void 0===l?void 0:l.nodeName))return;t.preventDefault();let u="function"==typeof(null===(i=navigator)||void 0===i?void 0:null===(n=i.clipboard)||void 0===n?void 0:n.read)?await navigator.clipboard.read():null==t?void 0:null===(a=t.clipboardData)||void 0===a?void 0:a.files;for(let t of(r(!0),u)){let r;if(null===(o=t.type)||void 0===o?void 0:o.startsWith("image/"))r=t;else for(let e of null===(d=t.types)||void 0===d?void 0:d.filter(e=>e.startsWith("image/")))r=await t.getType(e);if(r){let t=await g(r),l=await w({type:r.type,data:t,requirementId:e});await s.Iq.evidence.put(l)}}}finally{r(!1)}}}(t,0,a);return document.addEventListener("paste",e),()=>{document.removeEventListener("paste",e)}},[t,n,a]);let d=async e=>{a(!0),e.preventDefault();let r=new FormData(e.target);if(r.get("url")){var l;let n=r.get("url"),i=new URL(n),a=new TextEncoder().encode(n),o=await w({name:i.host||i.href,type:"url",data:a.buffer,requirementId:t});await s.Iq.evidence.put(o),null==e||null===(l=e.target)||void 0===l||l.reset()}return a(!1),!1};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h4",{className:"text-2xl block sm:flex mb-6 items-center -translate-y-full",children:"Evidence"}),(0,l.jsxs)("form",{className:"flex flex-col md:flex-row shrink mb-4 -translate-y-[36px]",onSubmit:d,children:[(0,l.jsxs)("div",{className:"basis-full mb-4 md:mb-0 md:basis-1/3 md:mr-4",children:[(0,l.jsx)(q,{requirementId:t,setUploading:a,uploading:i}),(0,l.jsxs)("div",{className:"relative w-full mt-4",children:[(0,l.jsx)("input",{type:"url",name:"url",id:"url",className:"bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg block w-full p-2.5",placeholder:"URL for evidence"}),(0,l.jsx)("button",{type:"submit",className:"absolute top-0 end-0 p-2.5 h-full rounded-e-lg flex items-center px-3 py-2 text-xs font-medium text-gray-600 bg-gray-100 border-l border-gray-200 border border-gray-200",children:(0,l.jsx)(N,{})})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap shrink basis-full md:basis-2/3 content-center",children:(0,l.jsx)(L,{evidence:r,setEvidence:n})})]})]})},M=e=>{let{children:t,debouncedSave:r,formAction:n,isHydrating:s,lastSaved:i,next:a,prev:o,requirement:d}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.o,{previous:o,next:a}),(0,l.jsxs)("div",{className:"sticky top-36 left-full flex flex-row-reverse items-center shrink-0 w-1/4 pb-4 z-20 -translate-y-full",children:[(0,l.jsx)("button",{type:"submit",className:"shrink w-24 bg-green-500 hover:bg-green-400 text-white font-bold py-2 px-4 border-b-4 border-green-700 hover:border-green-500 rounded disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:s,tabIndex:30,form:d.element_identifier,children:"Save"}),i&&(0,l.jsxs)("span",{className:"text-sm text-gray-500 mr-2 text-right hidden md:block",children:["Last saved: ",null==i?void 0:i.toLocaleTimeString()]})]}),(0,l.jsx)(C,{requirementId:d.element_identifier}),(0,l.jsx)("form",{id:d.element_identifier,action:n,onChange:r,className:"basis-full",children:t})]})},T=e=>{let{id:t,defaultValue:r,isPending:n}=e,[s,i]=(0,o.useState)(!!r),a=(0,o.useRef)(null),d=(0,o.useMemo)(()=>()=>!s&&i(!0),[s]),u=(0,o.useMemo)(()=>()=>{if(null==a?void 0:a.current){var e;null==a||null===(e=a.current)||void 0===e||e.dispatchEvent(new Event("change",{bubbles:!0})),d()}},[a,d]);return(0,l.jsxs)("div",{onBlur:u,onClick:d,onKeyUp:d,children:[(0,l.jsxs)("select",{id:t,name:t,ref:a,className:"h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",disabled:n,defaultValue:r,tabIndex:20,children:[(0,l.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,l.jsx)("option",{value:"implemented",children:"Implemented"}),(0,l.jsx)("option",{value:"not-applicable",children:"Not Applicable"}),(0,l.jsx)("option",{value:"not-started",children:"Not Started"})]},"".concat(t,"-").concat(n)),!s&&(0,l.jsx)("input",{type:"hidden",name:t,value:r})]})},F=e=>{let{securityRequirement:t,initialState:r,isPending:n}=e,s="".concat(t.subSubRequirement,".status");return(0,l.jsxs)("div",{className:"flex flex-col md:mr-2 lg:mr-4",children:[(0,l.jsx)("label",{htmlFor:s,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 my-2",children:"Status"}),(0,l.jsx)(T,{id:s,isPending:n,defaultValue:r[s]})]},s)},A=e=>{var t,r,n,s;let{securityRequirement:a,initialState:d,isPending:u}=e,c="".concat(a.subSubRequirement,".description"),m=(0,o.useRef)(null),x=(0,o.useRef)(null),v=(0,o.useRef)(null),[p,h]=(0,o.useState)(!0),[f,b]=(0,o.useState)(d[c]),g=(0,o.useMemo)(()=>()=>{var e;h(!1),null==m||null===(e=m.current)||void 0===e||e.focus()},[]),j=(0,o.useMemo)(()=>async()=>{if((null==x?void 0:x.current)&&(null==m?void 0:m.current)){var e;h(!0),x.current.innerHTML=await (0,i.xI)(null==m?void 0:null===(e=m.current)||void 0===e?void 0:e.value)}},[]);return(0,o.useEffect)(()=>{(async()=>{p&&f!==d[c]&&(b(d[c]),await j())})()},[f,d]),(0,o.useEffect)(()=>((null==m?void 0:m.current)&&(m.current.addEventListener("focus",g),m.current.addEventListener("blur",j)),v.current&&v.current.addEventListener("click",g),()=>{(null==m?void 0:m.current)&&(m.current.removeEventListener("focus",g),m.current.removeEventListener("blur",j)),v.current&&v.current.removeEventListener("click",g)}),[m,x]),(0,l.jsxs)("div",{className:"flex flex-col grow w-full lg:w-10/12",ref:v,children:[(0,l.jsx)("label",{htmlFor:c,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 my-2",children:"Description"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("textarea",{ref:m,tabIndex:20,name:c,id:c,className:"min-h-32 grow z-0 w-full rounded-md border border-input bg-transparent px-3 py-3 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm ".concat(p&&(null==m?void 0:null===(t=m.current)||void 0===t?void 0:t.value)?"absolute opacity-0":""),disabled:u,defaultValue:d[c],style:{height:(null==x?void 0:null===(r=x.current)||void 0===r?void 0:r.offsetHeight)?"".concat(null==x?void 0:null===(n=x.current)||void 0===n?void 0:n.offsetHeight,"px"):"auto"}}),(0,l.jsx)("div",{ref:x,tabIndex:-1,className:"min-h-32 relative z-10 md-output w-full rounded-md border border-input bg-white px-3 py-3 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm ".concat(p&&(null==m?void 0:null===(s=m.current)||void 0===s?void 0:s.value)?"":"hidden")})]})]})},P=e=>{let{securityRequirement:t,initialState:r,isPending:n,idx:s}=e;return(0,l.jsx)("li",{className:"mb-6",children:(0,l.jsxs)("fieldset",{className:"flex flex-col grow",children:[(0,l.jsxs)("legend",{className:"text-2xl flex flex-row items-center text-left",children:[(0,l.jsx)(f.oZ,{status:r["".concat(t.subSubRequirement,".status")]}),(0,l.jsx)("h4",{id:t.subSubRequirement,children:t.subSubRequirement})]}),(0,l.jsx)("p",{className:"text-lg my-2",children:t.text}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,l.jsx)(F,{securityRequirement:t,initialState:r,isPending:n,idx:s}),(0,l.jsx)(A,{securityRequirement:t,initialState:r,isPending:n})]})]})})},D=async(e,t)=>{var r,l;let n={};for(let[e,r]of t.entries()){let t=e.lastIndexOf("."),l=e.substring(0,t),s=e.substring(t+1);n[l]={...(null==n?void 0:n[l])||{},[s]:r}}for(let[e,t]of Object.entries(n))await (null===(l=s.Iq.securityRequirements)||void 0===l?void 0:l.put({id:e,...t}));let i=[];return await (null===(r=s.Iq.requirements)||void 0===r?void 0:r.put({id:e,bySecurityRequirementId:Object.entries(n).reduce((e,t)=>{let[r,l]=t;return e[r]=l.status,i.push(l.status),e},{})})),i},W=e=>{var t;let{requirement:r,initialState:n,setInitialState:s,groupings:i,isHydrating:a,setStatuses:d,prev:u,next:c}=e,[m,x]=(0,o.useState)(null);async function v(e,t){d(await D(r.id,t)),s(Object.fromEntries(t.entries())),x(new Date)}let p=(0,o.useMemo)(()=>(function(e,t){let r;return function(){for(var l=arguments.length,n=Array(l),s=0;s<l;s++)n[s]=arguments[s];r&&clearTimeout(r),r=setTimeout(()=>{e.apply(this,n)},t)}})(async e=>{var t;if(!(null===(t=e.target)||void 0===t?void 0:t.form))return;let r=new FormData(e.target.form);await v(null,r)},250),[r.id,d,s]),[h,f,b]=(0,o.useActionState)(v,n);return(0,l.jsx)(M,{debouncedSave:p,formAction:f,isHydrating:a,lastSaved:m,next:c,prev:u,requirement:r,children:(0,l.jsx)(l.Fragment,{children:null===(t=Object.entries(i))||void 0===t?void 0:t.map((e,t)=>{let[r,s]=e;return(0,l.jsx)("ol",{children:s.map(e=>(0,l.jsx)(P,{securityRequirement:e,initialState:n,isPending:b||a,idx:t},e.element_identifier))},r)})})})},B=e=>{var t,r,n,s,i,a,o,d;let{groupings:c,initialState:b,isHydrating:g,manifest:j,next:w,prev:y,requirement:N,requirementId:k,setInitialState:q,setStatuses:S,statuses:R,value:I}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.B,{requirementId:k}),(0,l.jsxs)("h3",{className:"text-3xl block sm:flex mt-6 items-center",children:["Security Requirements for ",N.requirement," ",N.title,(0,l.jsx)(f.oZ,{statuses:R})]}),(0,l.jsx)("p",{className:"text-base discussion",dangerouslySetInnerHTML:{__html:(null===(r=j.discussions.byRequirements[k])||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.text)||""}}),(0,l.jsxs)("aside",{className:"flex flex-wrap justify-between items-center w-full mx-auto",children:[(0,l.jsx)("div",{className:"flex mb-4 sm:mb-1",children:(0,l.jsxs)("a",{href:"https://csrc.nist.gov/projects/cprt/catalog#/cprt/framework/version/SP_800_171_3_0_0/home?element=".concat(N.id),target:"_blank",rel:"noreferrer",className:"text-xs text-gray-600",children:["View CPRT ",N.id]})}),(0,l.jsx)(v,{rows:[{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"revision-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Revision"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"revision-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"What NIST 800-171 revision(s) this control appears in."})]})]}),visible:null==I?void 0:null===(n=I.revision)||void 0===n?void 0:n.length,value:null==I?void 0:null===(s=I.revision)||void 0===s?void 0:s.join(", ")},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"value-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Value"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"value-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"The value this control has currently in CMMC."})]})]}),visible:!0,value:null==I?void 0:I.value},{title:"Partial Value",visible:(null!==(d=null==I?void 0:I.partial_value)&&void 0!==d?d:0)>0,value:null==I?void 0:I.partial_value},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"deprecated-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Deprecates"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"deprecated-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"This security requirement incorporates the following controls from revision 2."})]})]}),visible:!!(null==I?void 0:null===(i=I.withdrawn_from)||void 0===i?void 0:i.length),className:"hidden md:inline",value:null==I?void 0:null===(a=I.withdrawn_from)||void 0===a?void 0:a.map(e=>(0,l.jsx)(m(),{href:"/r3/requirement/".concat(e),className:"text-xs mr-2",children:e},e))},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"deprecated-value-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Deprecated Value"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"deprecated-value-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"This is the aggregate value of all controls this security requirement has incorporated. It is an estimate until CMMC is updated to use 800-171 revision 3."})]})]}),visible:!!(null==I?void 0:null===(o=I.withdrawn_from)||void 0===o?void 0:o.length),value:(0,u.k)(null==I?void 0:I.aggregate_value_withdrawn_from)}]})]}),(0,l.jsx)("section",{className:"w-full flex flex-col",children:(0,l.jsx)(W,{requirement:N,groupings:c,initialState:b,setInitialState:q,isHydrating:g,setStatuses:S,prev:y,next:w})})]})},G=/\d{2}.\d{2}.\d{2},?/gm,H=e=>{let{text:t}=e;if(G.test(t)){var r;return[t.replaceAll(G,"").replace("and","").replace(".",""),...null===(r=t.match(G))||void 0===r?void 0:r.map(e=>{let t=e.replace(",","");return(0,l.jsx)(m(),{href:"/r3/requirement/".concat(t),className:"text-xs mr-1",children:e},t)})]}return t},V=e=>{var t,r,n,s,i,a,o;let{initialState:d,isHydrating:u,manifest:c,next:m,prev:b,requirement:g,requirementId:j,setInitialState:w,setStatuses:y,statuses:N,value:k,withdrawn:q,groupings:S}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.B,{requirementId:j}),(0,l.jsxs)("h3",{className:"text-3xl mt-6 block sm:flex items-center",children:["Security Requirements for ",g.requirement,(0,l.jsx)(f.oZ,{statuses:N})]}),(0,l.jsxs)("div",{id:"alert-additional-content-5",className:"p-4 border border-yellow-100 text-yellow-800  rounded-lg bg-yellow-50 ",role:"alert",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{className:"sr-only",children:"Info"}),(0,l.jsx)("h3",{className:"text-lg font-sm text-gray-800 ",children:"Withdrawn"})]}),(0,l.jsx)("div",{className:"mt-2 mb-4 text-xs text-gray-800",children:(0,l.jsx)("p",{className:"mb-2",children:"This security requirement has been withdrawn from NIST-SP 800-171 revision 3, but is retained as CMMC is using revision 2."})})]}),(0,l.jsx)("p",{className:"text-base discussion",dangerouslySetInnerHTML:{__html:(null===(r=c.discussions.byRequirements[j])||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.text)||""}}),(0,l.jsxs)("aside",{className:"flex flex-wrap justify-between items-center w-full mx-auto",children:[(0,l.jsx)("div",{className:"flex mb-4 sm:mb-1",children:(0,l.jsxs)("a",{href:"https://csrc.nist.gov/projects/cprt/catalog#/cprt/framework/version/SP_800_171_3_0_0/home?element=".concat(g.id),target:"_blank",rel:"noreferrer",className:"text-xs text-gray-600",children:["View CPRT ",g.id]})}),(0,l.jsx)(v,{rows:[{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"revision-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Revision"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"revision-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"What NIST 800-171 revision(s) this control appears in."})]})]}),visible:null==k?void 0:null===(n=k.revision)||void 0===n?void 0:n.length,value:null==k?void 0:null===(s=k.revision)||void 0===s?void 0:s.join(", ")},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"value-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Value"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"value-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"The value this control has currently in CMMC."})]})]}),visible:!0,value:null==k?void 0:k.value},{title:"Partial Value",visible:(null!==(o=null==k?void 0:k.partial_value)&&void 0!==o?o:0)>0,value:null==k?void 0:k.partial_value},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"deprecated-value-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Withdrawn Reason"})," ",(0,l.jsx)(p.G,{})]}),(0,l.jsxs)(h.A,{id:"deprecated-value-popover",children:[(0,l.jsx)(p.G,{}),(0,l.jsx)("span",{children:"Why this security control was withdrawn."})]})]}),visible:!0,className:"hidden md:block",value:(0,l.jsx)(H,{text:null==q?void 0:null===(a=q[0])||void 0===a?void 0:null===(i=a.element)||void 0===i?void 0:i.text})}]})]}),(0,l.jsx)("section",{className:"w-full flex flex-col",children:(0,l.jsx)(W,{requirement:g,initialState:d,setInitialState:w,isHydrating:u,setStatuses:y,prev:b,next:m,groupings:S})})]})};i.xI.use({async:!0,pedantic:!1,gfm:!0,breaks:!0});let O=e=>{let{requirementId:t}=e,[r,i]=(0,o.useState)({}),[u,c]=(0,o.useState)(!1),[m,x]=(0,o.useState)([]),v=(0,n.u2)(),p=(0,a.useRouter)(),h=(0,d.S)(t),f=v.withdrawReason.byRequirements[t],b=(0,o.useMemo)(()=>(null==v?void 0:v.securityRequirements.byRequirements[t])||[],[v,t]),g=(0,o.useMemo)(()=>(null==v?void 0:v.requirements.byId[t])||null,[v,t]),j=(0,o.useMemo)(()=>{let e={};for(let t of b)t.text&&(e[t.subRequirement]||(e[t.subRequirement]=[]),e[t.subRequirement].push(t));return e},[b]),[w,y]=(0,o.useMemo)(()=>{let e=(null==v?void 0:v.requirements.byFamily[null==g?void 0:g.family])||[],r=e.findIndex(e=>e.id===t),l=e[r-1],n=e[r+1];if(!l||!n){var s,i,a;let e=v.families.elements,t=e.findIndex(e=>e.id===g.family);if(!l){let r=null==e?void 0:null===(s=e[t-1])||void 0===s?void 0:s.id,n=v.requirements.byFamily[r];l=null==n?void 0:n[(null==n?void 0:n.length)-1]}if(!n){let r=null==e?void 0:null===(i=e[t+1])||void 0===i?void 0:i.id;n=null===(a=v.requirements.byFamily[r])||void 0===a?void 0:a[0]}}return[l,n]},[g,t,v]);return((0,o.useEffect)(()=>{(async function(){c(!0);let e=b.map(e=>e.subSubRequirement),t=await s.Iq.securityRequirements.getAll(IDBKeyRange.bound(e[0],e[e.length-1])),r=[],l=null==t?void 0:t.reduce((e,t)=>(e["".concat(t.id,".status")]=t.status,e["".concat(t.id,".description")]=t.description,r.push(t.status),e),{});x(r),i(l),c(!1)})()},[t,i,b,x,c]),(0,o.useEffect)(()=>{let e=e=>{let t=new URL("".concat(window.location.origin,"/").concat(e.newURL.split("#")[1]));t.searchParams.get("element")&&(history.replaceState(null,"",window.location.pathname+window.location.search),p.push("/r3/requirement/".concat(t.searchParams.get("element"))))};window.addEventListener("hashchange",e);let t=e=>{if(e.ctrlKey&&"s"===e.key){var t;e.preventDefault();let r=null===(t=document.forms)||void 0===t?void 0:t[0];null==r||r.requestSubmit()}};return document.addEventListener("keydown",t),()=>{window.removeEventListener("hashchange",e),document.removeEventListener("keydown",t)}},[p]),f)?(0,l.jsx)(V,{groupings:j,initialState:r,isHydrating:u,manifest:v,next:y,prev:w,requirement:g,requirementId:t,setInitialState:i,setStatuses:x,statuses:m,value:h,withdrawn:f}):(null==b?void 0:b.length)?(0,l.jsx)(B,{groupings:j,initialState:r,isHydrating:u,manifest:v,next:y,prev:w,requirement:g,requirementId:t,setInitialState:i,setStatuses:x,statuses:m,value:h}):null}},4974:(e,t,r)=>{Promise.resolve().then(r.bind(r,7149)),Promise.resolve().then(r.bind(r,93)),Promise.resolve().then(r.bind(r,6236))},6616:(e,t,r)=>{"use strict";r.d(t,{o:()=>d});var l=r(5155),n=r(6874),s=r.n(n),i=r(2115);let a=e=>null==e?void 0:e.requirement;function o(e){let t=e.getBoundingClientRect();return t.top>=82&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}let d=e=>{let{previous:t,next:r,elementType:n="requirement",elementIdentity:d=a}=e,u=(0,i.useRef)(null),c=(0,i.useRef)(null),m="rounded-r-lg rounded-l-lg";t&&(m="rounded-r-lg");let x="rounded-r-lg rounded-l-lg";r&&(x="rounded-l-lg border-r"),(0,i.useEffect)(()=>{c.current&&o(c.current)?c.current.focus():u.current&&o(u.current)&&u.current.focus()},[u,c]);let v=d(t),p=d(r);return(0,l.jsxs)("aside",{className:"w-5/6 flex flex-row mb-4",children:[t&&(0,l.jsxs)(s(),{href:"/r3/".concat(n,"/").concat(v),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(x),tabIndex:10,ref:u,children:[(0,l.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),(0,l.jsxs)("span",{className:"mr-4 ml-2",children:[(0,l.jsx)("span",{children:v}),!!t.title&&(0,l.jsxs)("span",{className:"hidden md:inline",children:[": ",t.title]})]})]}),r&&(0,l.jsxs)(s(),{href:"/r3/".concat(n,"/").concat(p),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(m),tabIndex:11,ref:c,children:[(0,l.jsxs)("span",{className:"ml-4 mr-2",children:[(0,l.jsx)("span",{children:p}),!!r.title&&(0,l.jsxs)("span",{className:"hidden md:inline",children:[": ",r.title]})]}),(0,l.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,353,843,441,684,358],()=>t(4974)),_N_E=e.O()}]);