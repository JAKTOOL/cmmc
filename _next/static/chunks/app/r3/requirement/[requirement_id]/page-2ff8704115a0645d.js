(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{4974:(e,t,r)=>{Promise.resolve().then(r.bind(r,7149)),Promise.resolve().then(r.bind(r,7255)),Promise.resolve().then(r.bind(r,1801))},7255:(e,t,r)=>{"use strict";r.d(t,{SecurityRequirements:()=>L});var l=r(5155),s=r(1801),i=r(5383),n=r(8947),a=r(5695),d=r(2115),o=r(7182),u=r(8870),c=r(6874),m=r.n(c),x=r(2932);let v=e=>{let{rows:t}=e;return(0,l.jsx)("dl",{className:"flex flex-row",children:t.reduce((e,t,r)=>(void 0!==t.visible&&t.visible&&e.push((0,l.jsxs)("div",{className:t.className||"",children:[(0,l.jsx)("dt",{className:"text-xs text-gray-700 uppercase bg-gray-50 text-gray-700 border-gray-100 py-2 px-4 text-left border-r-2 border-b-2",children:t.title}),(0,l.jsx)("dd",{className:"text-xs text-gray-500 bg-white border-gray-200 py-2 px-4",children:t.value})]},r)),e),[])})};var f=r(8202),h=r(3437),p=r(2954);function b(e){let t=e.getBoundingClientRect();return t.top>=82&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}let g=e=>{let{previous:t,next:r}=e,s=(0,d.useRef)(null),i=(0,d.useRef)(null),n="rounded-r-lg rounded-l-lg";t&&(n="rounded-r-lg");let a="rounded-r-lg rounded-l-lg";return r&&(a="rounded-l-lg border-r"),(0,d.useEffect)(()=>{i.current&&b(i.current)?i.current.focus():s.current&&b(s.current)&&s.current.focus()},[s,i]),(0,l.jsxs)("aside",{className:"w-5/6 flex flex-row mb-4",children:[t&&(0,l.jsxs)(m(),{href:"/r3/requirement/".concat(t.requirement),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(a),tabIndex:10,ref:s,children:[(0,l.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),(0,l.jsxs)("span",{className:"mr-4 ml-2",children:[(0,l.jsx)("span",{children:t.requirement}),!!t.title&&(0,l.jsxs)("span",{className:"hidden md:inline",children:[": ",t.title]})]})]}),r&&(0,l.jsxs)(m(),{href:"/r3/requirement/".concat(r.requirement),className:"flex flex-row items-center bg-gray-200 text-gray-700 border-gray-400 py-2 px-4 border-b-4 hover:bg-gray-300 ".concat(n),tabIndex:11,ref:i,children:[(0,l.jsxs)("span",{className:"ml-4 mr-2",children:[(0,l.jsx)("span",{children:r.requirement}),!!r.title&&(0,l.jsxs)("span",{className:"hidden md:inline",children:[": ",r.title]})]}),(0,l.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})]})},j=async(e,t)=>{var r,l;let s={};for(let[e,r]of t.entries()){let t=e.lastIndexOf("."),l=e.substring(0,t),i=e.substring(t+1);s[l]={...(null==s?void 0:s[l])||{},[i]:r}}for(let[e,t]of Object.entries(s))await (null===(l=i.Iq.securityRequirements)||void 0===l?void 0:l.put({id:e,...t}));let n=[];return await (null===(r=i.Iq.requirements)||void 0===r?void 0:r.put({id:e,bySecurityRequirementId:Object.entries(s).reduce((e,t)=>{let[r,l]=t;return e[r]=l.status,n.push(l.status),e},{})})),n},w=e=>{let{children:t,debouncedSave:r,formAction:s,isHydrating:i,lastSaved:n,next:a,prev:d,requirement:o}=e;return(0,l.jsxs)("form",{id:o.element_identifier,action:s,onChange:r,className:"basis-full",children:[(0,l.jsx)(g,{previous:d,next:a}),(0,l.jsxs)("div",{className:"sticky top-36 left-full flex flex-row-reverse items-center shrink-0 w-1/4 pb-4 z-20 translate-y-px md:-translate-y-full",children:[(0,l.jsx)("button",{type:"submit",className:"shrink w-24 bg-green-500 hover:bg-green-400 text-white font-bold py-2 px-4 border-b-4 border-green-700 hover:border-green-500 rounded disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none",disabled:i,tabIndex:30,children:"Save"}),n&&(0,l.jsxs)("span",{className:"text-sm text-gray-500 mr-2 text-right hidden md:block",children:["Last saved: ",null==n?void 0:n.toLocaleTimeString()]})]}),t]})},y=e=>{let{id:t,defaultValue:r,isPending:s}=e,[i,n]=(0,d.useState)(!!r),a=(0,d.useRef)(null),o=(0,d.useMemo)(()=>()=>!i&&n(!0),[i]),u=(0,d.useMemo)(()=>()=>{if(null==a?void 0:a.current){var e;null==a||null===(e=a.current)||void 0===e||e.dispatchEvent(new Event("change",{bubbles:!0})),o()}},[a,o]);return(0,l.jsxs)("div",{onBlur:u,onClick:o,onKeyUp:o,children:[(0,l.jsxs)("select",{id:t,name:t,ref:a,className:"h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",disabled:s,defaultValue:r,tabIndex:20,children:[(0,l.jsx)("option",{value:"not-implemented",children:"Not Implemented"}),(0,l.jsx)("option",{value:"implemented",children:"Implemented"}),(0,l.jsx)("option",{value:"not-applicable",children:"Not Applicable"}),(0,l.jsx)("option",{value:"not-started",children:"Not Started"})]},"".concat(t,"-").concat(s)),!i&&(0,l.jsx)("input",{type:"hidden",name:t,value:r})]})},N=e=>{let{securityRequirement:t,initialState:r,isPending:s}=e,i="".concat(t.subSubRequirement,".status");return(0,l.jsxs)("div",{className:"flex flex-col md:mr-2 lg:mr-4",children:[(0,l.jsx)("label",{htmlFor:i,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 my-2",children:"Status"}),(0,l.jsx)(y,{id:i,isPending:s,defaultValue:r[i]})]},i)},q=e=>{var t,r,s,i;let{securityRequirement:a,initialState:o,isPending:u}=e,c="".concat(a.subSubRequirement,".description"),m=(0,d.useRef)(null),x=(0,d.useRef)(null),v=(0,d.useRef)(null),[f,h]=(0,d.useState)(!0),[p,b]=(0,d.useState)(o[c]),g=(0,d.useMemo)(()=>()=>{var e;h(!1),null==m||null===(e=m.current)||void 0===e||e.focus()},[]),j=(0,d.useMemo)(()=>async()=>{if((null==x?void 0:x.current)&&(null==m?void 0:m.current)){var e;h(!0),x.current.innerHTML=await (0,n.xI)(null==m?void 0:null===(e=m.current)||void 0===e?void 0:e.value)}},[]);return(0,d.useEffect)(()=>{(async()=>{f&&p!==o[c]&&(b(o[c]),await j())})()},[p,o]),(0,d.useEffect)(()=>((null==m?void 0:m.current)&&(m.current.addEventListener("focus",g),m.current.addEventListener("blur",j)),v.current&&v.current.addEventListener("click",g),()=>{(null==m?void 0:m.current)&&(m.current.removeEventListener("focus",g),m.current.removeEventListener("blur",j)),v.current&&v.current.removeEventListener("click",g)}),[m,x]),(0,l.jsxs)("div",{className:"flex flex-col grow w-full lg:w-10/12",ref:v,children:[(0,l.jsx)("label",{htmlFor:c,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 my-2",children:"Description"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("textarea",{ref:m,tabIndex:20,name:c,id:c,className:"min-h-32 grow z-0 w-full rounded-md border border-input bg-transparent px-3 py-3 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm ".concat(f&&(null==m?void 0:null===(t=m.current)||void 0===t?void 0:t.value)?"absolute opacity-0":""),disabled:u,defaultValue:o[c],style:{height:(null==x?void 0:null===(r=x.current)||void 0===r?void 0:r.offsetHeight)?"".concat(null==x?void 0:null===(s=x.current)||void 0===s?void 0:s.offsetHeight,"px"):"auto"}}),(0,l.jsx)("div",{ref:x,tabIndex:-1,className:"min-h-32 relative z-10 md-output w-full rounded-md border border-input bg-white px-3 py-3 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm ".concat(f&&(null==m?void 0:null===(i=m.current)||void 0===i?void 0:i.value)?"":"hidden")})]})]})},S=e=>{let{securityRequirement:t,initialState:r,isPending:s,idx:i}=e;return(0,l.jsx)("li",{className:"mb-6",children:(0,l.jsxs)("fieldset",{className:"flex flex-col grow",children:[(0,l.jsxs)("legend",{className:"text-2xl flex flex-row items-center text-left",children:[(0,l.jsx)(p.oZ,{status:r["".concat(t.subSubRequirement,".status")]}),(0,l.jsx)("h4",{id:t.subSubRequirement,children:t.subSubRequirement})]}),(0,l.jsx)("p",{className:"text-lg my-2",children:t.text}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,l.jsx)(N,{securityRequirement:t,initialState:r,isPending:s,idx:i}),(0,l.jsx)(q,{securityRequirement:t,initialState:r,isPending:s})]})]})})},R=e=>{var t;let{requirement:r,initialState:s,setInitialState:i,groupings:n,isHydrating:a,setStatuses:o,prev:u,next:c}=e,[m,x]=(0,d.useState)(null);async function v(e,t){o(await j(r.id,t)),i(Object.fromEntries(t.entries())),x(new Date)}let f=(0,d.useMemo)(()=>(function(e,t){let r;return function(){for(var l=arguments.length,s=Array(l),i=0;i<l;i++)s[i]=arguments[i];r&&clearTimeout(r),r=setTimeout(()=>{e.apply(this,s)},t)}})(async e=>{var t;if(!(null===(t=e.target)||void 0===t?void 0:t.form))return;let r=new FormData(e.target.form);await v(null,r)},250),[r.id,o,i]),[h,p,b]=(0,d.useActionState)(v,s);return(0,l.jsx)(w,{debouncedSave:f,formAction:p,isHydrating:a,lastSaved:m,next:c,prev:u,requirement:r,children:(0,l.jsx)(l.Fragment,{children:null===(t=Object.entries(n))||void 0===t?void 0:t.map((e,t)=>{let[r,i]=e;return(0,l.jsx)("ol",{children:i.map(e=>(0,l.jsx)(S,{securityRequirement:e,initialState:s,isPending:b||a,idx:t},e.element_identifier))},r)})})})},_=e=>{var t,r,s,i,n,a;let{groupings:d,initialState:o,isHydrating:c,manifest:b,next:g,prev:j,requirement:w,requirementId:y,setInitialState:N,setStatuses:q,statuses:S,value:_}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.B,{requirementId:y}),(0,l.jsxs)("h3",{className:"text-3xl block sm:flex mt-6 items-center",children:["Security Requirements for ",w.requirement," ",w.title,(0,l.jsx)(p.oZ,{statuses:S})]}),(0,l.jsx)("p",{className:"text-base discussion",dangerouslySetInnerHTML:{__html:(null===(r=b.discussions.byRequirements[y])||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.text)||""}}),(0,l.jsxs)("aside",{className:"flex flex-wrap justify-between items-center w-full mx-auto",children:[(0,l.jsx)("div",{className:"flex mb-4 sm:mb-1",children:(0,l.jsxs)("a",{href:"https://csrc.nist.gov/projects/cprt/catalog#/cprt/framework/version/SP_800_171_3_0_0/home?element=".concat(w.id),target:"_blank",rel:"noreferrer",className:"text-xs text-gray-600",children:["View CPRT ",w.id]})}),(0,l.jsx)(v,{rows:[{title:"Revision",visible:!0,value:null==_?void 0:_.revision},{title:"Value",visible:!0,value:null==_?void 0:_.value},{title:"Partial Value",visible:(null!==(a=null==_?void 0:_.partial_value)&&void 0!==a?a:0)>0,value:null==_?void 0:_.partial_value},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"deprecated-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Deprecates"})," ",(0,l.jsx)(f.G,{})]}),(0,l.jsxs)(h.A,{id:"deprecated-popover",children:[(0,l.jsx)(f.G,{}),(0,l.jsx)("span",{children:"This security requirement incorporates the following controls from revision 2."})]})]}),visible:!!(null==_?void 0:null===(s=_.withdrawn_from)||void 0===s?void 0:s.length),className:"hidden md:inline",value:null==_?void 0:null===(i=_.withdrawn_from)||void 0===i?void 0:i.map(e=>(0,l.jsx)(m(),{href:"/r3/requirement/".concat(e),className:"text-xs mr-2",children:e},e))},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"deprecated-value-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Deprecated Value"})," ",(0,l.jsx)(f.G,{})]}),(0,l.jsxs)(h.A,{id:"deprecated-value-popover",children:[(0,l.jsx)(f.G,{}),(0,l.jsx)("span",{children:"This is the aggregate value of all controls this security requirement has incorporated. It is an estimate until CMMC is updated to use 800-171 revision 3."})]})]}),visible:!!(null==_?void 0:null===(n=_.withdrawn_from)||void 0===n?void 0:n.length),value:(0,u.k)(null==_?void 0:_.aggregate_value_withdrawn_from)}]})]}),(0,l.jsx)("section",{className:"w-full flex flex-col",children:(0,l.jsx)(R,{requirement:w,groupings:d,initialState:o,setInitialState:N,isHydrating:c,setStatuses:q,prev:j,next:g})})]})},I=/\d{2}.\d{2}.\d{2},?/gm,k=e=>{let{text:t}=e;if(I.test(t)){var r;return[t.replaceAll(I,"").replace("and","").replace(".",""),...null===(r=t.match(I))||void 0===r?void 0:r.map(e=>{let t=e.replace(",","");return(0,l.jsx)(m(),{href:"/r3/requirement/".concat(t),className:"text-xs mr-1",children:e},t)})]}return t},E=e=>{var t,r,s,i,n;let{initialState:a,isHydrating:d,manifest:o,next:u,prev:c,requirement:m,requirementId:b,setInitialState:g,setStatuses:j,statuses:w,value:y,withdrawn:N,groupings:q}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.B,{requirementId:b}),(0,l.jsxs)("h3",{className:"text-3xl mt-6 block sm:flex items-center",children:["Security Requirements for ",m.requirement,(0,l.jsx)(p.oZ,{statuses:w})]}),(0,l.jsxs)("div",{id:"alert-additional-content-5",className:"p-4 border border-yellow-100 text-yellow-800  rounded-lg bg-yellow-50 ",role:"alert",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(f.G,{}),(0,l.jsx)("span",{className:"sr-only",children:"Info"}),(0,l.jsx)("h3",{className:"text-lg font-sm text-gray-800 ",children:"Withdrawn"})]}),(0,l.jsx)("div",{className:"mt-2 mb-4 text-xs text-gray-800",children:(0,l.jsx)("p",{className:"mb-2",children:"This security requirement has been withdrawn from NIST-SP 800-171 revision 3, but is retained as CMMC is using revision 2."})})]}),(0,l.jsx)("p",{className:"text-base discussion",dangerouslySetInnerHTML:{__html:(null===(r=o.discussions.byRequirements[b])||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.text)||""}}),(0,l.jsxs)("aside",{className:"flex flex-wrap justify-between items-center w-full mx-auto",children:[(0,l.jsx)("div",{className:"flex mb-4 sm:mb-1",children:(0,l.jsxs)("a",{href:"https://csrc.nist.gov/projects/cprt/catalog#/cprt/framework/version/SP_800_171_3_0_0/home?element=".concat(m.id),target:"_blank",rel:"noreferrer",className:"text-xs text-gray-600",children:["View CPRT ",m.id]})}),(0,l.jsx)(v,{rows:[{title:"Revision",visible:!0,value:null==y?void 0:y.revision},{title:"Value",visible:!0,value:null==y?void 0:y.value},{title:"Partial Value",visible:(null!==(n=null==y?void 0:y.partial_value)&&void 0!==n?n:0)>0,value:null==y?void 0:y.partial_value},{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{popoverTarget:"deprecated-value-popover",className:"uppercase flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"Withdrawn Reason"})," ",(0,l.jsx)(f.G,{})]}),(0,l.jsxs)(h.A,{id:"deprecated-value-popover",children:[(0,l.jsx)(f.G,{}),(0,l.jsx)("span",{children:"Why this security control was withdrawn."})]})]}),visible:!0,className:"hidden md:block",value:(0,l.jsx)(k,{text:null==N?void 0:null===(i=N[0])||void 0===i?void 0:null===(s=i.element)||void 0===s?void 0:s.text})}]})]}),(0,l.jsx)("section",{className:"w-full flex flex-col",children:(0,l.jsx)(R,{requirement:m,initialState:a,setInitialState:g,isHydrating:d,setStatuses:j,prev:c,next:u,groupings:q})})]})};n.xI.use({async:!0,pedantic:!1,gfm:!0,breaks:!0});let L=e=>{let{requirementId:t}=e,[r,n]=(0,d.useState)({}),[u,c]=(0,d.useState)(!1),[m,x]=(0,d.useState)([]),v=(0,s.u2)(),f=(0,a.useRouter)(),h=(0,o.S)(t),p=v.withdrawReason.byRequirements[t],b=(0,d.useMemo)(()=>(null==v?void 0:v.securityRequirements.byRequirements[t])||[],[v,t]),g=(0,d.useMemo)(()=>(null==v?void 0:v.requirements.byId[t])||null,[v,t]),j=(0,d.useMemo)(()=>{let e={};for(let t of b)t.text&&(e[t.subRequirement]||(e[t.subRequirement]=[]),e[t.subRequirement].push(t));return e},[b]),[w,y]=(0,d.useMemo)(()=>{let e=(null==v?void 0:v.requirements.byFamily[null==g?void 0:g.family])||[],r=e.findIndex(e=>e.id===t),l=e[r-1],s=e[r+1];if(!l||!s){var i,n,a;let e=v.families.elements,t=e.findIndex(e=>e.id===g.family);if(!l){let r=null==e?void 0:null===(i=e[t-1])||void 0===i?void 0:i.id,s=v.requirements.byFamily[r];l=null==s?void 0:s[(null==s?void 0:s.length)-1]}if(!s){let r=null==e?void 0:null===(n=e[t+1])||void 0===n?void 0:n.id;s=null===(a=v.requirements.byFamily[r])||void 0===a?void 0:a[0]}}return[l,s]},[g,t,v]);return((0,d.useEffect)(()=>{(async function(){c(!0);let e=b.map(e=>e.subSubRequirement),t=await i.Iq.securityRequirements.getAll(IDBKeyRange.bound(e[0],e[e.length-1])),r=[],l=null==t?void 0:t.reduce((e,t)=>(e["".concat(t.id,".status")]=t.status,e["".concat(t.id,".description")]=t.description,r.push(t.status),e),{});x(r),n(l),c(!1)})()},[t,n,b,x,c]),(0,d.useEffect)(()=>{let e=e=>{let t=new URL("".concat(window.location.origin,"/").concat(e.newURL.split("#")[1]));t.searchParams.get("element")&&(history.replaceState(null,"",window.location.pathname+window.location.search),f.push("/r3/requirement/".concat(t.searchParams.get("element"))))};window.addEventListener("hashchange",e);let t=e=>{if(e.ctrlKey&&"s"===e.key){var t;e.preventDefault();let r=null===(t=document.forms)||void 0===t?void 0:t[0];null==r||r.requestSubmit()}};return document.addEventListener("keydown",t),()=>{window.removeEventListener("hashchange",e),document.removeEventListener("keydown",t)}},[f]),p)?(0,l.jsx)(E,{groupings:j,initialState:r,isHydrating:u,manifest:v,next:y,prev:w,requirement:g,requirementId:t,setInitialState:n,setStatuses:x,statuses:m,value:h,withdrawn:p}):(null==b?void 0:b.length)?(0,l.jsx)(_,{groupings:j,initialState:r,isHydrating:u,manifest:v,next:y,prev:w,requirement:g,requirementId:t,setInitialState:n,setStatuses:x,statuses:m,value:h}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,353,843,441,684,358],()=>t(4974)),_N_E=e.O()}]);